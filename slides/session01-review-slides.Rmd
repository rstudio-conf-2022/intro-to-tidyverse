---
title: "Session 1 Review"
subtitle: "Day 1, Session 1"
author: "Desirée De Leon"
date: "July 25, 2022"
shortlink:
  url: https://github.com/rstudio-conf-2022/intro-to-tidyverse/tree/main/materials/session01
  text: materials/session01
output:
  xaringan::moon_reader:
    css: ["default", "assets/academy-theme.css", "assets/session01.css"]
    seal: false
    lib_dir: libs
    nature:
      highlightStyle: github
      highlightLines: true
      countIncrementalSlides: false
      ratio: "16:9"
params:
  wifi_network: ""
  wifi_password: ""
---
class: middle, chapter-slide

```{r setup, include=FALSE}
options(htmltools.dir.version = FALSE)

xaringanExtra::use_xaringan_extra(c("tile_view", "panelset", "share_again"))
xaringanExtra::use_clipboard(selector = "pre > code.r, pre > code.md")
xaringanExtra::use_tachyons()

if (!is.null(rmarkdown::metadata$shortlink)) {
  shortlink <- rmarkdown::metadata$shortlink
  if (is.character(shortlink)) {
    shortlink <- list(url = shortlink)
  }
  stopifnot(!is.null(shortlink$url))
  
  if (is.null(shortlink$text) || !nzchar(shortlink$text)) {
    shortlink$text <- basename(shortlink$url)
  }
  
  xaringanExtra::use_banner(
    bottom_left = htmltools::tags$a(href = shortlink$url, shortlink$text),
    exclude = "title-slide"
  )
}
```

.pull-left[
.big-text.near-black[Welcome]

Find your group's table and make yourself comfortable. 

We'll get started shortly after 9am.]

.pull-right[

Schematic of table layout goes here.

]

---
class: inverse middle

# Conference workshop policies

.left-column[

  .center[

  `r emo::ji("door")` `r emo::ji("dash")` 

  <br>

  `r emo::ji("no_entry_sign")` `r emo::ji("camera")` 

  <br>
  <br>

  `r emo::ji("yoga")` `r emo::ji("tent")`
  ]
]

.right-column[

  Identify the exits closest to you in case of emergency 

  <br>

  Please do not photograph people wearing .light-red[red lanyards] 

  <br>

  A chill-out room is available for neurologically diverse attendees on the 4th floor of tower 1
] 

---

# Code of conduct

- Please review the [rstudio::conf code of conduct](https://rstd.io/code-of-conduct) that applies to all workshops <https://rstd.io/code-of-conduct>

--

- CoC issues can be addressed three ways:

  - In person: contact any rstudio::conf staff member or the conference registration desk
  - By email: send a message to `conf@rstudio.com`
  - By phone: call 844-448-1212
  
---
class: middle, center

.pull-left[
# `r fontawesome::fa("fas fa-wifi")`
Wifi network name  

`r params$wifi_network`

]

.pull-left[
# `r fontawesome::fa("fas fa-key")`

Wifi password

`r params$wifi_password`

]

---
class: top, center
background-image: url(https://images.unsplash.com/photo-1520962880247-cfaf541c8724?ixlib=rb-1.2.1&ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&auto=format&fit=crop&w=1332&q=80)
background-position: center
background-size: contain

# Goals

Drill old wrangling skills and explore new ones

Learn best practices for exploring your data and reporting it reproducibly 


???

Welcome to _Introduction to the Tidyverse_. This is the first in-person component we're including in an RStudio Academ course, and we're excited to pilot this with you all to allow for more group work, exposure to new project and datasets, and increased access to mentors and instructors. For the next two days, our goals are to:

1. Drill old wrangling skills and explore new ones

1. Learn best practices for exploring your data and report it reproducibly -- including doing this in your local RStudio IDE, outside of Academy.

In short, we're using these two days to give you sanctioned time to dive deep into the skills you've been learning the past few weeks with a lot of protected time for practice. 

[Will we build in opps for more learning and drilling during downtime?]


---
class: center, middle, chapter-slide blue

.big-text.white[Hello!]

???

And so with that, let me introduce myself...


---
class: speaker-slide

# `r rmarkdown::metadata$author`

<!-- You can copy the image link address from your github profile to use as the src link below --> 

<img style="border-radius: 50%;" src="https://avatars.githubusercontent.com/u/29008894?v=4" width="200px"/>

.speaker-links[
[`r fontawesome::fa("github")` dcossyleon](https://github.com/dcossyleon)    
[`r fontawesome::fa("twitter")` dcossyle](https://twitter.com/dcossyle)   
[`r fontawesome::fa("link")` desiree.rbind.io](https://desiree.rbind.io)
]

---

Placeholder for team slide...

???

But there's an entire team of people behind the work and content that you're seeing today. Here are some of their faces. You'll be hearing from them as speakers today, some of them are your mentors, and of course, there are a whole host of other folks who couldn't be at the conference with us today, but whose fingerprints are all over the lessons and tech that you have been experiencing at Academy. 

---

line up image

???
 
The lineup for the next couple days...


---
 day 1
 
 day 2

---

day 1 day 2 detailed
---

schedule

???

Now that we have an overview of the next two days...

---

You'll notice that each session for the next two days has its own workspace in conf2022.rstudioacademy.com

You can navigate there now...

One exception is Session 4....

---
class: center, middle, chapter-slide blue

.big-text.white[Let's get to work!]

---
class: title-slide

# `r rmarkdown::metadata$title`

### `r rmarkdown::metadata$subtitle`

<div class="title-footer">
  <img src="images/academy-logo.png">
  <div> `r rmarkdown::metadata$author` • `r rmarkdown::metadata$date`</div>
</div>

???

We're going to start off with some review of what we've learned for the past couple weeks.

---

Screenshot of workspace

for this session, we'll be doing our work in this part of the Academy website. 

Go ahead and open up the milestone for this session.  


---

What we'll do:

I'm going to give you a few prompts and/or recreations, and you'll work with your group to recreate these. 


You'll do your work in this RMd, yo ucan create as many code chunks as you like in here. Do you work in the Rmd document so you have a record of your code.

---

RULES:

For each prompt, the first group to have everyone with the answer correct (as verified by your mentor), will win a small prize. 

You must have the correct code and the correct output.

After a few more minutes, we'll go over the answer together. And then move on to the next question. 

???

After the conference, you'll be able to see these slides (with the prompts) linked on our website.

---
class: center, middle
background-image: url(https://images.unsplash.com/photo-1579780864813-863e246d3bc5?ixlib=rb-1.2.1&ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&auto=format&fit=crop&w=1160&q=80)
background-position: center
background-size: cover

# 

.big-text.white[Outbreaks data]

```{r load-data, include=FALSE}
library(tidyverse)

readxl::read_excel("data/session01/NationalOutbreakPublicDataTool.xlsx", sheet = 1) %>%
  janitor::clean_names() %>%
  readr::write_csv("data/session01/outbreaks.csv")
```


???

We'll be working with data about foodborne and waterborne disease outbreaks spread by contact with environmental sources or infected people or animals. This dataset comes from the CDC's National 
National Outbreak Reporting System (NORS).

First things first, let's take a look a what's in this dataset. 

So here is your first prompt:

---
class: your-turn

# Your Turn 1

Can you recreate output that looks like this?

```{r read-in-outbreaks, include = FALSE}
outbreaks <- readr::read_csv("data/session01/outbreaks.csv")
```

```{r echo = FALSE}
glimpse(outbreaks)
#str(outbreaks)
```

???

3 minutes to read in the data and run glimpse()?
---

Show Solution.

Static or live code in box?

---
class: your-turn

# Your Turn 2

What is the earliest year on record in this dataset? Latest?

---

Solution

```{r}
outbreaks %>%
  arrange(year)

outbreaks %>%
  arrange(desc(year))
```

---
class: your-turn
# Your Turn 3

The `state` variable appears to include US locations -- is the data limited to the 50 states?


---

Solution: 

```{r}
outbreaks %>%
  count(state)
```

---
class: your-turn
# Your Turn 4

Let's turn our attention to only observations where the primary mode of infection is Food. Using that criterion, can you reproduce the table below?

```{r echo = FALSE}
outbreaks %>%
  filter(primary_mode == "Food") %>% 
  count(ifsac_category)
```

???

---

Solution:

```{r eval = FALSE}
outbreaks %>%
  filter(primary_mode == "Food") %>% 
  count(ifsac_category)
```


---
class: your-turn

# Your Turn 5

What are the different etiologies that have been recorded in this dataset? Display them in a table like the one below.

```{r echo = FALSE}
outbreaks %>%
  count(etiology)
```

---

Solution:

```{r}
outbreaks %>%
  count(etiology)
```


---
class: your-turn

# Your Turn 6

Explore the relationship between `month` and the number of illnesses with a plot like this one. Can you recreate it?

```{r, echo = FALSE}
outbreaks %>% 
  ggplot(mapping = aes(x = month, y = illnesses)) + 
  geom_point()
```



---

Solution:

```{r eval = FALSE}
outbreaks %>% 
  ggplot(mapping = aes(x = month, y = illnesses)) + 
  geom_point()
```

---
class: your-turn

# Your Turn 7

Subset the data before plotting to inspect the outlier in a plot like this:

```{r echo = FALSE}
outbreaks %>%
  filter(
    illnesses >= 400000
  ) %>%
  ggplot(mapping = aes(x = month, y = illnesses)) + 
  geom_point()
```

---

Solution:

```{r eval = FALSE}
outbreaks %>%
  filter(
    illnesses >= 400000
  ) %>%
  ggplot(mapping = aes(x = month, y = illnesses)) + 
  geom_point()

```

---
class: your-turn

# Your Turn 8

Which observation in `outbreaks` is associated with such a high number of illnesses? Display solely this observation in a table.

---

One possible solution:

```{r}
outbreaks %>%
  filter(
    illnesses >= 400000
  )
```

---
class: your-turn

# Your Turn 9

Which observations lead to the highest number of illnesses? Display them in a table from greatest to fewest illnesses.

---

Solution:

```{r}
outbreaks %>% arrange(desc(illnesses))
```

---
class: your-turn

# Your Turn 10

Excluding the previous observation, has the number of illnesses decreased throughout the years? Explore this question with a visualization.

```{r echo = FALSE}
outbreaks %>%
  filter(
    illnesses < 400000
  ) %>% 
  ggplot(
    mapping = aes(x = year, y = illnesses)
  ) + 
  geom_point() + 
  geom_smooth()
```

---

One possible solution:

```{r eval = FALSE}
outbreaks %>%
  filter(
    illnesses < 400000
  ) %>% 
  ggplot(
    mapping = aes(x = year, y = illnesses)
  ) + 
  geom_point() + 
  geom_smooth()
```

---
class: your-turn
# Your Turn 11

How many primary modes of illness does this dataset contain?

---

One possible solution:

```{r eval = FALSE}
outbreaks %>%
  count(primary_mode)
```


---
class: your-turn

# Your Turn 12

Which primary mode is responsible for the greatest number of reported outbreaks? Explore this with a visualization.


---

Solution:


```{r}
outbreaks %>%
  ggplot(mapping = aes(x = primary_mode)) + 
  geom_bar() +
  coord_flip()
```

---
class: your-turn

# Your Turn 13

Excluding the outlier, is there a relationship between year and number of illnesses, categorized by primary mode?

```{r echo = FALSE}
outbreaks %>%
  filter(illnesses < 40000) %>% 
  ggplot(mapping = aes(y = illnesses, x = year, color = primary_mode, alpha = 0.1)) + 
  geom_point()
```


---

Solution:

```{r}
outbreaks %>%
  filter(illnesses < 40000) %>% 
  ggplot(mapping = aes(y = illnesses, x = year, color = primary_mode, alpha = 0.1)) + 
  geom_point()
```

---
class: your-turn

# Your Turn 14

Show the distribution of the number of illnesses for each primary mode, excluding the outlier.

```{r echo = FALSE}
outbreaks %>%
  filter(illnesses < 40000) %>% 
  ggplot(mapping = aes(x = primary_mode, y = illnesses, color = primary_mode)) + 
  geom_point(alpha = 0.01) + 
  geom_boxplot()
```

---

Solution:

```{r eval = FALSE}
outbreaks %>%
  filter(illnesses < 40000) %>% 
  ggplot(mapping = aes(x = primary_mode, y = illnesses, color = primary_mode)) + 
  geom_point(alpha = 0.01) + 
  geom_boxplot()
```


---
class: your-turn

# Your Turn 15

Visualize the number of outbreaks in Washington DC in this dataset, grouped by primary mode of infection.

```{r echo = FALSE}
outbreaks %>% 
  filter(state == "Washington DC") %>%
  ggplot(mapping = aes(x = primary_mode)) +
  geom_bar()

```

---

Solution:

```{r}
outbreaks %>% 
  filter(state == "Washington DC") %>%
  ggplot(mapping = aes(x = primary_mode)) +
  geom_bar()

```

---
class: your-turn

# Your Turn 16 

Let's focus only on DC and foodborne illnesses now. Show the most recent outbreaks in a table, from most recent to least reaent.

---

Solution:

```{r echo = FALSE}
outbreaks %>% 
  filter(
    state == "Washington DC" & 
    primary_mode == "Food"
    ) %>%
  arrange(desc(year), desc(month))
```

---
class: your-turn

# Your Turn 17

Find food-related outbreaks that resulted in at least 1 death. Display the results in a table that contains only the columns from `year` to `deaths`.

---

Solution:

```{r}
outbreaks %>% 
  filter(
    primary_mode == "Food", 
    deaths >= 1
  ) %>% 
  select(year:deaths)
```

---
class: your-turn
# Your Turn 18

Calculate new variable for each outbreak: the fatality rate (the  number of deaths / the number of illnesses, multipled by 100). Then visualize the distribution of the fatality rate.

---

Solution:

```{r}
outbreaks %>% 
  select(1:3, deaths, illnesses) %>% 
  mutate(
    fatality_rate = deaths/illnesses*100
  ) %>%
  ggplot(mapping = aes(x = fatality_rate)) + 
  geom_histogram()
```

---
class: your-turn

# Your Turn 19

Remove outbreaks that have a fatality rate of zero. What is the distribution of the fatality rate for the remaining outbreaks?

---

Solution:

```{r}
outbreaks %>% 
  select(1:3, deaths, illnesses) %>% 
  mutate(
    fatality_rate = deaths/illnesses*100
  ) %>%
  filter(fatality_rate > 0) %>%
  ggplot(mapping = aes(x = fatality_rate)) + 
  geom_histogram()
```

---
class: your-turn
# Your Turn 20

Find DC's worst outbreak according to the outbreak's hospitalization rate. Your answer should be a tibble with the highest hospitalization rates shown at the top. Any ties should be broken by outbreaks that happened more recently.

```{r echo = FALSE}
outbreaks %>% 
  filter(state == "Washington DC") %>% 
  mutate(
    hosp_rate = hospitalizations/illnesses*100
  ) %>%
  arrange(desc(hosp_rate), desc(year))
```


---
class: your-turn
# Your Turn 21

X Use a window function + plot it

```{r}

```

---
class: your-turn
# Your Turn 22


Mean center something (?) and then plot it

```{r}

```
