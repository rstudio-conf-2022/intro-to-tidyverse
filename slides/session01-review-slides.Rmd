---
title: "Session 1 Review"
subtitle: "Day 1, Session 1"
author: "Desirée De Leon"
date: "July 25, 2022"
shortlink:
  url: "https://github.com/rstudio-conf-2022/intro-to-tidyverse/tree/main/materials/session01"
  text: ""
output:
  xaringan::moon_reader:
    css: ["default", "assets/academy-theme.css", "assets/session01.css"]
    seal: false
    lib_dir: libs
    nature:
      highlightStyle: github
      highlightLines: true
      countIncrementalSlides: false
      ratio: "16:9"
params:
  wifi_network: "conf22"
  wifi_password: "together!"
---
class:

```{r setup, include=FALSE}
options(htmltools.dir.version = FALSE)
knitr::opts_chunk$set(fig.retina = 3)
library(tidyverse)
```

```{r reactable-function, include=FALSE}
reactable_preview <- function(data) {
  
  page_info <- "{rowStart}-{rowEnd} of {rows} rows"
  
  if (nrow(data) > 100) {
    page_info <- glue::glue(
      "{page_info} (Total: {actual})", 
      actual = format(nrow(data), big.mark = ",")
    )
  }
  
  data %>% 
    slice_head(n = 100) %>% 
    reactable::reactable(
      defaultColDef = reactable::colDef(align = "left", maxWidth = 400),
      defaultPageSize = 8, 
      compact = TRUE,
      wrap = FALSE,
      striped = TRUE,
      sortable = FALSE, 
      showPageInfo = TRUE,
      language = reactable::reactableLang(
        pageInfo = page_info
      )
    )
}
```

```{r xaringan-stuff, include=FALSE}
xaringanExtra::use_xaringan_extra(c("tile_view", "panelset", "share_again"))
xaringanExtra::use_clipboard(selector = "pre > code.r, pre > code.md")
xaringanExtra::use_tachyons()

if (!is.null(rmarkdown::metadata$shortlink)) {
  shortlink <- rmarkdown::metadata$shortlink
  if (is.character(shortlink)) {
    shortlink <- list(url = shortlink)
  }
  stopifnot(!is.null(shortlink$url))
  
  if (is.null(shortlink$text) || !nzchar(shortlink$text)) {
    shortlink$text <- basename(shortlink$url)
  }
  
  xaringanExtra::use_banner(
    bottom_left = htmltools::tags$a(href = shortlink$url, shortlink$text),
    exclude = "title-slide"
  )
}
```


# .big-text[Welcome] 

## Introduction to the tidyverse 

Find your group's table and make yourself comfortable. 

We'll get started shortly after 9am.


<div class="title-footer">
  <img src="images/academy-logo.png">
  <div> </div>
</div>

---
class: middle, agenda

# Session 1 Agenda

1. Logistics: Policies, Goals, and Schedules
1. Review: Group challenge

---
class: middle chapter-slide blue

.big-white-number[1.]

# Policies, Goals, & Schedules

---

class: inverse, middle

# Conference workshop policies

.left-column[

  .center[

  `r emo::ji("door")` `r emo::ji("dash")` 

  <br>

  `r emo::ji("no_entry_sign")` `r emo::ji("camera")` 

  <br>

  `r emo::ji("person_in_lotus_position")` `r emo::ji("tent")`
  
  <br>
  <br>
  
  `r emo::ji("face_with_medical_mask")` `r emo::ji("microbe")`
  ]
]

.right-column[

  Identify the exits closest to you in case of emergency 

  <br>

  Please do not photograph people wearing .light-red[red lanyards] 

  <br>

  A meditation / chill-out room is open 8am-5pm in the Potomac Dressing Room if you want quiet space to recharge.
  
   <br>
   
  Fully cover your mouth and nose at all times
   
] 

---

# Code of conduct

- Please review the [rstudio::conf code of conduct](https://rstd.io/code-of-conduct) that applies to all workshops <https://rstd.io/code-of-conduct>

--

- CoC issues can be addressed three ways:

  - In person: contact any rstudio::conf staff member or the conference registration desk
  - By email: send a message to `conf@rstudio.com`
  - By phone: call 844-448-1212
  
  
---
class: middle, center

.pull-left[
# `r fontawesome::fa("fas fa-wifi")`
Wifi network name  

`r params$wifi_network`

]

.pull-right[
# `r fontawesome::fa("fas fa-key")`

Wifi password

`r params$wifi_password`

]

---
class: center, top
background-image: url(https://images.unsplash.com/photo-1520962880247-cfaf541c8724?ixlib=rb-1.2.1&ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&auto=format&fit=crop&w=1332&q=80)
background-position: center
background-size: cover

# Goals


???

Welcome to _Introduction to the Tidyverse_. This is the first in-person component we're including in an RStudio Academy course, and we're excited to pilot this with you all to allow for more group work, exposure to new project and datasets, and increased access to mentors and instructors. For the next two days, our goals are to:

1. Drill old wrangling skills and explore new ones

1. Learn best practices for exploring your data and report it reproducibly -- including doing this in your local RStudio IDE, outside of Academy.

In short, we're using these two days to give you sanctioned time to dive deep into the skills you've been learning the past few weeks with a lot of protected time for practice. 

[Will we build in opps for more learning and drilling during downtime?]

--

Drill old wrangling skills and explore new ones

--

Learn best practices for exploring your data and reporting it reproducibly 


---
class: center, middle, chapter-slide red

.big-text.white.center[Hello!]

???

And so with that, let me introduce myself...


---
class: speaker-slide

# `r rmarkdown::metadata$author`

<!-- You can copy the image link address from your github profile to use as the src link below --> 

<img style="border-radius: 50%;" src="https://avatars.githubusercontent.com/u/29008894?v=4" width="200px"/>

.speaker-links[
[`r fontawesome::fa("github")` dcossyleon](https://github.com/dcossyleon)    
[`r fontawesome::fa("twitter")` dcossyle](https://twitter.com/dcossyle)   
[`r fontawesome::fa("link")` desiree.rbind.io](https://desiree.rbind.io)
]

---
class: center

# Meet the team

<div class="cf-ns nl2 nr2">
  <div class="fl-ns w-20-ns pv4">
    <div class="tc">
      <img src="https://avatars.githubusercontent.com/u/8742033?v=4" class="br-100 pa1 ba b--black-10 h4 w4" alt="avatar">
    </div>
    <div class="f6 fw6 gray ttu tracked mt2">
      Kristin Bott
    </div>
  </div>


  <div class="fl-ns w-20-ns pv4">
    <div class="tc">
      <img src="https://avatars.githubusercontent.com/u/32279312?v=4" class="br-100 pa1 ba b--black-10 h4 w4" alt="avatar">
    </div>
    <div class="f6 fw6 gray ttu tracked mt2">
      Brendan Cullen
    </div>
  </div>
  
  
  <div class="fl-ns w-20-ns pv4">
    <div class="tc">
      <img src="https://avatars.githubusercontent.com/u/5782147?v=4" class="br-100 pa1 ba b--black-10 h4 w4" alt="avatar">
    </div>
    <div class="f6 fw6 gray ttu tracked mt2">
      Daniel Chen
    </div>
  </div>
  
  
  <div class="fl-ns w-20-ns pv4">
    <div class="tc">
      <img src="https://avatars.githubusercontent.com/u/18153457?v=4" class="br-100 pa1 ba b--black-10 h4 w4" alt="avatar">
    </div>
    <div class="f6 fw6 gray ttu tracked mt2">
      Sara Altman
    </div>
  </div>
  
  <div class="fl-ns w-20-ns pv4">
    <div class="tc">
      <img src="https://avatars.githubusercontent.com/u/49049415?v=4" class="br-100 pa1 ba b--black-10 h4 w4" alt="avatar">
    </div>
    <div class="f6 fw6 gray ttu tracked mt2">
      Deirdre Francks
    </div>
  </div>
  
  <div class="fl-ns w-20-ns pv4">
    <div class="tc">
      <img src="https://avatars.githubusercontent.com/u/34824840?v=4" class="br-100 pa1 ba b--black-10 h4 w4" alt="avatar">
    </div>
    <div class="f6 fw6 gray ttu tracked mt2">
Steven Smallberg    </div>
  </div>
  
  
  <div class="fl-ns w-20-ns pv4">
    <div class="tc">
      <img src="https://avatars.githubusercontent.com/u/36464703?v=4" class="br-100 pa1 ba b--black-10 h4 w4" alt="avatar">
    </div>
    <div class="f6 fw6 gray ttu tracked mt2">
Laura Puckett    </div>
  </div>
  
  
  <div class="fl-ns w-20-ns pv4">
    <div class="tc">
      <img src="https://avatars.githubusercontent.com/u/85014?v=4" class="br-100 pa1 ba b--black-10 h4 w4" alt="avatar">
    </div>
    <div class="f6 fw6 gray ttu tracked mt2">
      Garrett Grolemund    
    </div>
  </div>
  
  
  <div class="fl-ns w-20-ns pv4">
    <div class="tc">
      <img src="https://avatars.githubusercontent.com/u/45143?v=4" class="br-100 pa1 ba b--black-10 h4 w4" alt="avatar">
    </div>
    <div class="f6 fw6 gray ttu tracked mt2">
      Dan Buch
    </div>
  </div>
  
  <div class="fl-ns w-20-ns pv4">
    <div class="tc">
      <img src="https://avatars.githubusercontent.com/u/5420529?v=4" class="br-100 pa1 ba b--black-10 h4 w4" alt="avatar">
    </div>
    <div class="f6 fw6 gray ttu tracked mt2">
      Garrick Aden-Buie
    </div>
  </div>
  
  
  
</div>



???

But there's an entire team of people behind the work and content that you're seeing today. Here are some of their faces. You'll be hearing from them as speakers today, some of them are your mentors, and of course, there are a whole host of other folks who couldn't be at the conference with us today, but whose fingerprints are all over the lessons and tech that have made the Academy experience you're going through possible. 

---


class: middle, center
background-image: url("images/session01/scooters.jpg")
background-size: cover

---
class: middle, center
background-image: url("images/session01/scooters-dark.png")
background-size: cover

# .big-text.white[The Lineup]

???
 
Here is what we have lined up for you for the next couple days...


---
class: middle, center

.pull-left[

# Day One:

### Review + Best Practices
]

--

.pull-right[

# Day Two:

### Transformation + Milestone  

]

---
class: middle, center

.pull-left[

# Day One:

### Review + Best Practices

Review

Exploratory data analysis

R Markdown for reproducible results

R Projects and your local IDE
]

--

.pull-right[

# Day Two:

### Transformation + Milestone  

Summarize data and work with groups

Recoding variables + Milestone recreation

Lightning talks + Milestone extension

Milestone presentation
]

---
class: center

???
this is our schedule. And this is where we'll work...

You'll notice that each session for the next two days has its own workspace in conf2022.rstudioacademy.com

You can navigate there now...One exception is Session 4....


--

.left-column1[

# Schedule

.spaced[

| Time          | Activity                                                      |
|:--------------|:--------------------------------------------------------------|
| 09:00 - 10:30 | Session 1                                                     |
| 10:30 - 11:00 | *Break* `r emo::ji("coffee")`                                 |
| 11:00 - 12:30 | Session 2                                                     |
| 12:30 - 01:30 | *Lunch* `r emo::ji("bento")`                                  |  
| 01:30 - 03:00 | Session 3                                                     |
| 03:00 - 03:30 | *Break* `r emo::ji("tea")`                                    |
| 03:30 - 05:00 | Session 4                                                     |

]
]

--

.right-column63[
# Workspace
<img src="images/session01/campsite_screenshot.png">
]


---
class: middle, chapter-slide green

.big-white-number[2.]

# Review: Group challenge

---
class: title-slide

# `r rmarkdown::metadata$title`

### `r rmarkdown::metadata$subtitle`

<div class="title-footer">
  <img src="images/academy-logo.png">
  <div> `r rmarkdown::metadata$author` • `r rmarkdown::metadata$date`</div>
</div>

???

We're going to start off with some review of what we've learned for the past couple weeks.

---
class: inverse

### Go to **Conf Session 1 - Review**

.center[
```{r session1-workspace, echo = FALSE, out.width = "80%", fig.align = "center"}
knitr::include_graphics("images/session01/campsite_screenshot.png")
```
]

???

for this session, we'll be doing our work in this part of the Academy website. 

Go ahead and open up the milestone for this Session 1.

---

## `r emo::ji("rocket")` Rapid fire review 

???

What we'll do:

I'm going to give you a few prompts and/or recreations, and you'll work with your group to recreate these. 

You'll do your work in the R Markdown document you have open so you have a record of your code. You can create as many code chunks as you like in here. 

--

.pull-left[
```{r label, echo = FALSE}
knitr::include_graphics("images/session01/your-turn-example.png")
```
]

--

.pull-right[

```{r solution, echo = FALSE}
knitr::include_graphics("images/session01/your-turn-example.png")
```
]

---

# Review game rules

* For each prompt, the __first group with 4 or more people to have the answer correct__ (as verified by your mentor), scores a point.

--

* You must have the __correct code__ *and* the __correct output__.

--

* __Working together__ with your groupmates is encouraged.

--

* After 1-2 minutes, we'll go over the answer together. And then move on to the next question. 

--

* Group with the most points at the end wins

???

After the conference, you'll be able to see these slides (with all the prompts) linked on our website.

---
class: center, middle
background-image: url(https://images.unsplash.com/photo-1579780864813-863e246d3bc5?ixlib=rb-1.2.1&ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&auto=format&fit=crop&w=1160&q=80)
background-position: center
background-size: cover

???

We'll be working with data about foodborne and waterborne disease outbreaks

---
class: center, middle, inverse
background-image: url(https://images.unsplash.com/photo-1579780864813-863e246d3bc5?ixlib=rb-1.2.1&ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&auto=format&fit=crop&w=1160&q=80)
background-position: center
background-size: cover

```{r load-data, include=FALSE}
library(tidyverse)

readxl::read_excel("data/session01/NationalOutbreakPublicDataTool.xlsx", sheet = 1) %>%
  janitor::clean_names() %>%
  readr::write_csv("data/session01/outbreaks.csv")
```

# .big-text[`outbreaks`]

???

...spread by contact with environmental sources or infected people or animals. I'll refer to this dataset as `outbreaks`. It comes from the CDC's National Outbreak Reporting System (NORS).

First things first, let's take a look a what's in this dataset. 

So *here* is your first prompt:

---
class: your-turn

# Your Turn 1

Read in the data and explore it. Can you recreate output that looks like this?

```{r read-in-outbreaks, include = FALSE}
outbreaks <- readr::read_csv("data/session01/outbreaks.csv")
```

.space-saver[
```{r echo = FALSE}
glimpse(outbreaks)
#str(outbreaks)
```
]

???

1 minute to read in the data and run `glimpse()`

---

## Solution 1
.pull-left[
```{r sol-1, eval = FALSE}
library(tidyverse)

outbreaks <- 
  read_csv("data/outbreaks.csv")

glimpse(outbreaks)
```
]

.pull-right.space-saver[
```{r echo = FALSE, message = FALSE}
glimpse(outbreaks)
```
]

---
class: your-turn

# Your Turn 2

What is the* **earliest year** on record in this dataset? **The latest**? 

Answer the questions by creating two tables that are sorted.

---

## Solution 2

.pull-left[
```{r eval = FALSE, echo = TRUE}
outbreaks %>%
  arrange(year)
```

.space-saver[
```{r echo = FALSE}
outbreaks %>%
  arrange(year) %>% 
  reactable_preview()
```
]
]

.pull-right[
```{r eval = FALSE}
outbreaks %>%
  arrange(desc(year))
```

.space-saver[
```{r echo = FALSE}
outbreaks %>%
  arrange(desc(year)) %>% 
  reactable_preview()
```
]
]

---
class: your-turn

# Your Turn 3

The `state` variable appears to include US locations -- is the data limited to the 50 states? 

Produce a table that displays all the unique values of this variable.


---

## Solution 3

```{r sol-3, echo = TRUE, eval = FALSE}
outbreaks %>%
  distinct(state)
```

```{r, echo = FALSE, eval = TRUE}
outbreaks %>%
  distinct(state) %>% 
  reactable_preview()
```

---
class: your-turn

# Your Turn 4

What are the different etiologies that have been recorded in this dataset, and how often do they appear in the data? Display your results in a table like the one below.

```{r echo = FALSE}
outbreaks %>%
  count(etiology) %>% 
  reactable_preview()
```

---

## Solution 4

```{r eval = FALSE}
outbreaks %>%
  count(etiology)
```

```{r echo = FALSE}
outbreaks %>%
  count(etiology) %>% 
  reactable_preview()
```


---
class: your-turn

# Your Turn 5

Let's turn our attention to only observations where the primary mode of infection is Food. Using that criterion, can you reproduce the table below?

```{r echo = FALSE}
outbreaks %>%
  filter(primary_mode == "Food") %>% 
  count(ifsac_category) %>% 
  reactable_preview()
```

???

---

## Solution 5

```{r echo = TRUE, eval = FALSE}
outbreaks %>%
  filter(primary_mode == "Food") %>% 
  count(ifsac_category)
```

```{r echo = FALSE}
outbreaks %>%
  filter(primary_mode == "Food") %>% 
  count(ifsac_category) %>% 
  reactable_preview()
```


---
class: your-turn

# Your Turn 6

.pull-left[
Explore the relationship between `month` and the number of illnesses with a series of **boxplots** like the one to the right. Can you recreate it? 
]

.pull-right[
```{r sol-6, echo = FALSE}
outbreaks %>% 
  ggplot(aes(x = month, y = illnesses)) + 
  geom_boxplot(aes(group = month)) #<<
```
]


???

Check documentation for use of the argument that allows you to create a new boxplot for each grouping.

---

## Solution 6

.wide-left[
```{r ref.label = "sol-6", fig.show = "hide"}
```
]

.narrow-right[
```{r ref.label = "sol-6", echo = FALSE}
```
]

???

But outlier here makes it hard to see what's going on. Let's modify this.

---
class: your-turn

# Your Turn 7

Which observation in `outbreaks` is the outlier associated with such a high number of illnesses? 

  * Display solely this observation in a table. 

  * Then, recreate the boxplots **without** this observation.

---
class: space-saver

## Solution 7

.pull-left[

```{r eval = FALSE}
outbreaks %>%
  filter(illnesses == max(illnesses))
```

]

.pull-right[
```{r echo = FALSE}
outbreaks %>%
  filter(illnesses == max(illnesses)) %>% 
  reactable_preview()
```

<br>

]

--

.pull-left[
```{r sol-7-fig, fig.asp = 1/2, fig.show = "hide"}
outbreaks %>%
  filter(illnesses != max(illnesses)) %>% #<<
  ggplot(aes(x = month, y = illnesses)) + 
  geom_boxplot(aes(group = month))
```
]

.pull-right[
```{r ref.label= "sol-7-fig", echo = FALSE, fig.asp = 3/5}

```

]

---
class: your-turn

# Your Turn 8

Which outbreaks lead to the highest number of illnesses? Display these observations in a table from greatest to fewest illnesses.

---
class: space-saver

## Solution 8

```{r eval = FALSE}
outbreaks %>% arrange(desc(illnesses))
```

```{r echo = FALSE}
outbreaks %>% arrange(desc(illnesses)) %>% 
  reactable_preview()
```


---
class: your-turn

# Your Turn 9

How many different primary modes of illness are in this dataset? How often does each appear in the data?

Order the rows so that the most common primary mode appears at the top. 

---

## Solution 9

```{r eval = FALSE}
outbreaks %>%
  count(primary_mode) %>% 
  arrange(desc(n))
```

```{r echo = FALSE}
outbreaks %>%
  count(primary_mode) %>% 
  arrange(desc(n)) %>% 
  reactable_preview()
```

???

Looks like the most common primary moe for outbreaks in this particular dataset is person-to-person.

---
class: your-turn

# Your Turn 10

.pull-left[Can you figure out how to recreate this visualization of the **primary modes** of infection?]

.pull-right[
```{r echo = FALSE}
outbreaks %>%
  ggplot(mapping = aes(x = primary_mode)) + 
  geom_bar() +
  coord_flip() 
```
]

???

---

## Solution 10

.pull-left[
```{r sol-10, eval = FALSE}
outbreaks %>%
  ggplot(aes(x = primary_mode)) + 
  geom_bar() +
  coord_flip() #<<
```
]

.pull-right[
```{r ref.label = "sol-10", echo = FALSE}

```
]

???

Notice coord_flip()

If your first inclination was to use count() then you might have come up with an answer like...

---

## Solution 10 - alternative

.wide-left[
```{r sol-10-alt, eval = FALSE}
outbreaks %>%
  count(primary_mode, name = "count") %>% #<<
  ggplot(aes(x = primary_mode, y = count)) + 
  geom_col() + #<<
  coord_flip()
```
]

.narrow-right[
```{r ref.label = "sol-10-alt", echo = FALSE}

```
]

???

This one, but it's a little less efficient code-wise.

---
class: your-turn

# Your Turn 11 

Let's take a closer look at outbreaks associated with **Animal Contact**. 

* Which *individual* states have had the most Animal Contact outbreaks -- how many has each state had? 

* Create a table that contains the answer to both of these questions.  


---

## Solution 11

One possible solution:

```{r eval = FALSE}
outbreaks %>%
  filter(primary_mode == "Animal Contact") %>% 
  count(state) %>% 
  filter(state != "Multistate") %>%  #<<
  arrange(desc(n))
```

```{r echo = FALSE}
outbreaks %>%
  filter(primary_mode == "Animal Contact") %>% 
  count(state) %>% 
  filter(state != "Multistate") %>% 
  arrange(desc(n)) %>% 
  reactable_preview()
```

---
class: your-turn

# Your Turn 12

.left-column35[
Now that we know the top 3 states are **Ohio**, **Minnesota**, and **Idaho**, recreate this table:

* Has only the Animal Contact outbreaks for those locations  

* Column names with "animal" appear after `state`

* Drop the `primary_mode` column
]

.right-column63.space-saver[
```{r sol-12, echo = FALSE}
outbreaks %>%
  filter(
    primary_mode == "Animal Contact", 
    state %in% c("Ohio", "Minnesota", "Idaho")
  ) %>% 
  relocate(
    contains("animal"), 
    .after = state
  ) %>% 
  select(-primary_mode) %>% 
  reactable_preview()
```
]

---
class: space-saver

## Solution 12

```{r eval = FALSE}
outbreaks %>%
  filter(
    primary_mode == "Animal Contact", 
    state %in% c("Ohio", "Minnesota", "Idaho")
  ) %>% 
  relocate(
    contains("animal"), 
    .after = state
  ) %>% 
  select(-primary_mode)
```

```{r ref.label = "sol-12", echo = FALSE}

```

---
class: your-turn

# Your Turn 13

.pull-left[Excluding the outlier we previously identified, visualize the relationship between **year** and number of **illnesses** with a smooth line plot.   

Color each line by its primary mode.]

.pull-right[

```{r echo = FALSE, message = FALSE}
outbreaks %>%
  filter(illnesses != max(illnesses)) %>% 
  ggplot(aes(y = illnesses, x = year, color = primary_mode)) + 
  geom_smooth(se = FALSE)
```
]

---

## Solution 13

.pull-left[
```{r sol-13, eval = FALSE, message = FALSE}
outbreaks %>%
  filter(illnesses != max(illnesses)) %>% 
  ggplot(aes(y = illnesses, x = year, color = primary_mode)) + 
  geom_smooth(se = FALSE)
```
]

.pull-right[
```{r ref.label = "sol-13", echo = FALSE, message = FALSE}
```
]


---
class: your-turn

# Your Turn 14

Visualize the number of illnesses in **Washington DC**, grouped by **primary mode** of infection. *Hint: you may need to investigate violin plot*

```{r sol-14, echo = FALSE, fig.height = 4.5, fig.width = 11, out.width = "80%"}
outbreaks %>% 
  filter(state == "Washington DC") %>%
  ggplot(aes(x = primary_mode, y = illnesses)) +
  geom_violin(aes(color = primary_mode)) + 
  geom_point(alpha = 0.3) # any alpha value < 1 is OK
```

---

## Solution 14


```{r ref.label = "sol-14", fig.show = "hide", message = FALSE, warning = FALSE}
```


```{r ref.label = "sol-14", echo = FALSE, message = FALSE, fig.height = 4.5, fig.width = 11, out.width = "75%", warning = FALSE}
```

---
class: your-turn

# Your Turn 15

Let's focus only on **Washington DC** and **food borne illnesses**. Show the most recent outbreaks in a table from most recent to least recent.

---

## Solution 15 

.left-column40[
```{r eval = FALSE}
outbreaks %>% 
  filter(
    state == "Washington DC" & 
    primary_mode == "Food"
  ) %>%
  arrange(desc(year), desc(month))
```
]

.right-column55[
```{r echo = FALSE}
outbreaks %>% 
  filter(
    state == "Washington DC" & 
    primary_mode == "Food"
    ) %>%
  arrange(desc(year), desc(month)) %>% 
  reactable_preview()
```
]

---
class: your-turn

# Your Turn 16

Continue to focus only on **Washington DC** and **food borne illnesses**. Use tidyverse functions to display the unique values of `food_vehicle` as a vector.

---
## Solution 16

.left-column1[
```{r sol-16, eval = FALSE}
outbreaks %>% 
  filter(
    state == "Washington DC",
    primary_mode == "Food"
  ) %>%
  distinct(food_vehicle) %>% 
  pull()
```
]

.right-column55[
```{r ref.label = "sol-16", echo = FALSE}

```

]




---
class: your-turn

# Your Turn 17

Find **food borne** outbreaks that resulted in at least 1 **death**. Display the results in a table that contains only the columns from `year` to `deaths`.

---

## Solution

```{r eval = FALSE}
outbreaks %>% 
  filter(
    primary_mode == "Food", 
    deaths >= 1
  ) %>% 
  select(year:deaths)
```

```{r echo = FALSE}
outbreaks %>% 
  filter(
    primary_mode == "Food", 
    deaths >= 1
  ) %>% 
  select(year:deaths) %>% 
  reactable_preview()
```

---
class: your-turn

# Your Turn 18

Calculate new variable for each outbreak: **`fatality_rate`** (the  number of deaths / the number of illnesses, multiplied by 100). Then visualize the distribution of the fatality rate with a histogram.

---

## Solution 18
.pull-left[
```{r sol-18, fig.show = "hide", message = FALSE}
outbreaks %>% 
  select(1:3, deaths, illnesses) %>% 
  mutate(
    fatality_rate = deaths / illnesses * 100
  ) %>%
  ggplot(aes(x = fatality_rate)) + 
  geom_histogram()
```
]

.pull-right[

```{r ref.label = "sol-18", echo = FALSE, warning = FALSE, message = FALSE}

```
]


---
class: your-turn

# Your Turn 19

* Remove outbreaks that have a fatality rate of zero. 

* What is the distribution of the fatality rate for the remaining outbreaks as shown by a **notched boxplot**?

* Make the interior of your notched boxplot solid .blue[blue].

---

## Solution 19

.pull-left[
```{r sol-19, fig.show = "hide"}
outbreaks %>% 
  select(1:3, deaths, illnesses) %>% 
  mutate(
    fatality_rate = deaths / illnesses * 100
  ) %>%
  filter(fatality_rate > 0) %>%
  ggplot(aes(x = fatality_rate)) + 
  geom_boxplot(
    notch = TRUE,
    fill = "blue" 
  )
```
]

.pull-right[
```{r ref.label = "sol-19", echo = FALSE}
```
]

---
class: your-turn

# Your Turn 20 - last one!

Find Washington DC's worst outbreak as defined by its **`hospitalization_rate`** (which you will need to calculate).

* Subset the data so you display observations that are at least 60% greater than DC's mean hopsitalization rate. 

* Your answer should be a tibble with the highest hospitalization rates shown at the top. 

* Any ties should be broken by outbreaks that happened more recently.



---

## Solution 20

```{r eval = FALSE}
outbreaks %>% 
  filter(state == "Washington DC") %>% 
  mutate(hospitalization_rate = hospitalizations / illnesses * 100) %>%
  filter(hospitalization_rate >= 1.60 * mean(hospitalization_rate, na.rm = TRUE)) %>% 
  arrange(desc(hospitalization_rate), desc(year))
```


```{r echo = FALSE}
outbreaks %>% 
  filter(state == "Washington DC") %>% 
  mutate(hospitalization_rate = hospitalizations / illnesses * 100) %>%
  filter(hospitalization_rate >= 1.60 * mean(hospitalization_rate, na.rm = TRUE)) %>% 
  arrange(desc(hospitalization_rate), desc(year)) %>% 
  reactable_preview()
```
---

# Explore

+ Now, pair-up with at least one other groupmate and do something new with the `outbreaks` data (10 + minutes)

+ Then share with your group.

---
class: blue, middle, center

# .big-text.white[The end `r emo::ji("rocket")`]

---
background-image: url("https://images.unsplash.com/photo-1518541355664-6ca16f8aacf5?ixlib=rb-1.2.1&ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&auto=format&fit=crop&w=1740&q=80")
background-position: left
background-size: cover

### Next up: Coffee Break

Meet back here at 11:00am for Session 2

